"use strict";var __extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),__makeTemplateObject=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__decorate=this&&this.__decorate||function(e,t,n,o){var r,s=arguments.length,l=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(s<3?r(l):s>3?r(t,n,l):r(t,n))||l);return s>3&&l&&Object.defineProperty(t,n,l),l};Object.defineProperty(exports,"__esModule",{value:!0});var templateObject_1,templateObject_2,lit_element_1=require("lit-element"),Draggable=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.placeholder="placeholder",t.mouseIsDown=!1,t.startPos={X:0,Y:0},t.detached=!1,t}return __extends(t,e),Object.defineProperty(t,"styles",{get:function(){return lit_element_1.css(templateObject_1||(templateObject_1=__makeTemplateObject(["\n      :host {\n        display: block;\n        -moz-user-select: none;\n        user-select: none;\n      }\n    "],["\n      :host {\n        display: block;\n        -moz-user-select: none;\n        user-select: none;\n      }\n    "])))},enumerable:!0,configurable:!0}),t.prototype.render=function(){return lit_element_1.html(templateObject_2||(templateObject_2=__makeTemplateObject(["<slot></slot>"],["<slot></slot>"])))},t.prototype.firstUpdated=function(e){var t=this;this.addEventListener("mousedown",function(e){return t.onMouseDown(e)}),document.body.addEventListener("mouseup",function(){t.detached&&t.onMouseUp(t)}),document.body.addEventListener("mousemove",function(e){t.mouseIsDown&&t.onMouseMove(e)})},t.prototype.onMouseDown=function(e){this.mouseIsDown=!0,this.startPos={X:e.clientX-this.getBoundingClientRect().left,Y:e.clientY-this.getBoundingClientRect().top}},t.prototype.onMouseUp=function(e){e.mouseIsDown=!1;var t=e.getRelatedElementsUnder();e.style.position="",e.style.width="";var n=e.parentElement.parentElement.querySelector(this.placeholder);t.taskList.insertBefore(e,n),n.style.display="none",e.detached=!1},t.prototype.onMouseMove=function(e){if(!this.detached){var t=getComputedStyle(this),n=this.parentElement.parentElement.querySelector(this.placeholder);this.parentElement.insertBefore(n,this),Object.assign(n.style,{width:t.width,height:t.height,display:"block"}),this.parentElement.parentElement.appendChild(this),this.style.width=t.width,this.style.position="fixed",this.detached=!0}var o=e.clientX-this.startPos.X,r=e.clientY-this.startPos.Y;this.style.left=o+"px",this.style.top=r+"px";var s=this.getRelatedElementsUnder();if(null!=s.closestDraggable){n=this.parentElement.parentElement.querySelector(this.placeholder);s.middlePoint.Y<=this.getMiddlePoint(s.closestDraggable).Y&&this.lastHoveredDraggable!=s.closestDraggable?(s.taskList.insertBefore(n,s.closestDraggable),this.lastHoveredDraggable=s.closestDraggable):this.lastHoveredDraggable!=s.closestDraggable.nextSibling&&(s.taskList.insertBefore(n,s.closestDraggable.nextSibling),this.lastHoveredDraggable=s.closestDraggable.nextSibling)}},t.prototype.getRelatedElementsUnder=function(){var e=this.getMiddlePoint(),t=document.elementsFromPoint(e.X,e.Y);return{closestDraggable:t.filter(function(e){return"DRAGGABLE-ELEMENT"==e.tagName})[1],taskList:t.filter(function(e){return"TASKLIST"==e.tagName})[0],middlePoint:e}},t.prototype.getMiddlePoint=function(e){void 0===e&&(e=this);var t=e.getBoundingClientRect();return{X:t.width/2+t.left,Y:t.height/2+t.top}},t=__decorate([lit_element_1.customElement("draggable-element")],t)}(lit_element_1.LitElement);exports.Draggable=Draggable;